{
  "all": {
    "events": {
      "EVDAV": {
        "bizlogic": {
          "type": "cel",
          "cel": "{\n  'out': (\n    let notificationOut = (\n      has(enrichment.productCategory.productCategory) && \n      has(message.MPE.manualScan.auxiliaryData.data) ?\n      \n      (enrichment.productCategory.productCategory == 'Tracked24' ? \n        (message.MPE.manualScan.auxiliaryData.data.exists(d, d.name == 'RECIPIENT_EMAILID') ? \n          [\n            {\n              'type': 'notification',\n              'trackedEventCode': 'NRARS',\n              'originatingTrackedEventCode': 'EVDAV',\n              'notificationDestination': message.MPE.manualScan.auxiliaryData.data.filter(d, d.name == 'RECIPIENT_EMAILID')[0].value,\n              'notificationDestinationType': 1,\n              'notificationRecipientType': 'R',\n              'eventTimestamp': message.MPE.manualScan.eventTimestamp,\n              'uniqueItemId': message.MPE.mailPiece.mailPieceBarcode.channelSegment.uniqueItemId,\n              'UPUTrackingNumber': message.MPE.mailPiece.mailPieceBarcode.channelSegment.UPUTrackingNumber\n            }\n          ] \n          : []\n        )\n      :\n      enrichment.productCategory.productCategory == 'SpecialDelivery09' ?\n        (\n          (message.MPE.manualScan.auxiliaryData.data.exists(d, d.name == 'RECIPIENT_EMAILID') ? \n            [\n              {\n                'type': 'notification',\n                'trackedEventCode': 'NRGRS',\n                'originatingTrackedEventCode': 'EVDAV',\n                'notificationDestination': message.MPE.manualScan.auxiliaryData.data.filter(d, d.name == 'RECIPIENT_EMAILID')[0].value,\n                'notificationDestinationType': 1,\n                'notificationRecipientType': 'R',\n                'eventTimestamp': message.MPE.manualScan.eventTimestamp,\n                'uniqueItemId': message.MPE.mailPiece.mailPieceBarcode.channelSegment.uniqueItemId,\n                'UPUTrackingNumber': message.MPE.mailPiece.mailPieceBarcode.channelSegment.UPUTrackingNumber\n              }\n            ] \n            : []\n          ) +\n          (message.MPE.manualScan.auxiliaryData.data.exists(d, d.name == 'RECIPIENT_MOBILENO') ? \n            [\n              {\n                'type': 'notification',\n                'trackedEventCode': 'NRGRS',\n                'originatingTrackedEventCode': 'EVDAV',\n                'notificationDestination': message.MPE.manualScan.auxiliaryData.data.filter(d, d.name == 'RECIPIENT_MOBILENO')[0].value,\n                'notificationDestinationType': 2,\n                'notificationRecipientType': 'R',\n                'eventTimestamp': message.MPE.manualScan.eventTimestamp,\n                'uniqueItemId': message.MPE.mailPiece.mailPieceBarcode.channelSegment.uniqueItemId,\n                'UPUTrackingNumber': message.MPE.mailPiece.mailPieceBarcode.channelSegment.UPUTrackingNumber\n              }\n            ] \n            : []\n          )\n        )\n      :\n      enrichment.productCategory.productCategory == 'SpecialDelivery13' ?\n        (message.MPE.manualScan.auxiliaryData.data.exists(d, d.name == 'RECIPIENT_MOBILENO') ? \n          [\n            {\n              'type': 'notification',\n              'trackedEventCode': 'NRJRS',\n              'originatingTrackedEventCode': 'EVDAV',\n              'notificationDestination': message.MPE.manualScan.auxiliaryData.data.filter(d, d.name == 'RECIPIENT_MOBILENO')[0].value,\n              'notificationDestinationType': 2,\n              'notificationRecipientType': 'R',\n              'eventTimestamp': message.MPE.manualScan.eventTimestamp,\n              'uniqueItemId': message.MPE.mailPiece.mailPieceBarcode.channelSegment.uniqueItemId,\n              'UPUTrackingNumber': message.MPE.mailPiece.mailPieceBarcode.channelSegment.UPUTrackingNumber\n            }\n          ] \n          : []\n        )\n      : []\n      )\n      : []\n    );\n    \n    let trackingOut = [\n      {\n        'type': 'tracking',\n        'eventCode': 'EVDAV',\n        'eventName': 'Accepted at Depot',\n        'eventDateTime': message.MPE.manualScan.eventTimestamp,\n        'uniqueItemId': message.MPE.mailPiece.mailPieceBarcode.channelSegment.uniqueItemId,\n        'UPUTrackingNumber': message.MPE.mailPiece.mailPieceBarcode.channelSegment.UPUTrackingNumber,\n        'productId': message.MPE.mailPiece.mailPieceBarcode.channelSegment.productId,\n        'productName': enrichment.productCategory.productCategory,\n        'functionalLocationId': has(message.MPE.manualScan.RMGLocation.functionalLocationId) ? message.MPE.manualScan.RMGLocation.functionalLocationId : '',\n        'siteId': has(message.MPE.manualScan.RMGLocation.siteId) ? message.MPE.manualScan.RMGLocation.siteId : '',\n        'locationName': has(enrichment.postcodeRegion) ? enrichment.postcodeRegion : '',\n        'postcode': message.MPE.mailPiece.mailPieceBarcode.channelSegment.destinationPostcodeDPS.postcode,\n        'destinationCountry': message.MPE.mailPiece.mailPieceBarcode.channelSegment.destinationCountry\n      }\n    ];\n    \n    notificationOut + trackingOut\n  )\n}\n"
        }
      },
      "EVIMC": {
        "bizlogic": {
          "type": "cel",
          "cel": "{\n  'out': [\n    {\n      'type': 'tracking',\n      'eventCode': 'EVIMC',\n      'eventName': 'In Transit at Mail Centre',\n      'eventDateTime': message.MPE.manualScan.eventTimestamp,\n      'uniqueItemId': message.MPE.mailPiece.mailPieceBarcode.channelSegment.uniqueItemId,\n      'UPUTrackingNumber': message.MPE.mailPiece.mailPieceBarcode.channelSegment.UPUTrackingNumber,\n      'productId': message.MPE.mailPiece.mailPieceBarcode.channelSegment.productId,\n      'productName': enrichment.productCategory.productCategory,\n      'functionalLocationId': has(message.MPE.manualScan.RMGLocation.functionalLocationId) ? message.MPE.manualScan.RMGLocation.functionalLocationId : '',\n      'siteId': has(message.MPE.manualScan.RMGLocation.siteId) ? message.MPE.manualScan.RMGLocation.siteId : '',\n      'locationName': has(enrichment.sortingCenter) ? enrichment.sortingCenter : '',\n      'postcode': message.MPE.mailPiece.mailPieceBarcode.channelSegment.destinationPostcodeDPS.postcode,\n      'destinationCountry': message.MPE.mailPiece.mailPieceBarcode.channelSegment.destinationCountry\n    }\n  ]\n}\n"
        }
      },
      "EVGPD": {
        "bizlogic": {
          "type": "cel",
          "cel": "{\n  'out': (\n    let notificationOut = (\n      has(enrichment.productCategory.productCategory) && \n      has(message.MPE.manualScan.auxiliaryData.data) ?\n      \n      (enrichment.productCategory.productCategory == 'Tracked24' ? \n        (\n          (message.MPE.manualScan.auxiliaryData.data.exists(d, d.name == 'RECIPIENT_EMAILID') ? \n            [\n              {\n                'type': 'notification',\n                'trackedEventCode': 'NRBRS',\n                'originatingTrackedEventCode': 'EVGPD',\n                'notificationDestination': message.MPE.manualScan.auxiliaryData.data.filter(d, d.name == 'RECIPIENT_EMAILID')[0].value,\n                'notificationDestinationType': 1,\n                'notificationRecipientType': 'R',\n                'eventTimestamp': message.MPE.manualScan.eventTimestamp,\n                'uniqueItemId': message.MPE.mailPiece.mailPieceBarcode.channelSegment.uniqueItemId,\n                'UPUTrackingNumber': message.MPE.mailPiece.mailPieceBarcode.channelSegment.UPUTrackingNumber\n              }\n            ] \n            : []\n          ) +\n          (message.MPE.manualScan.auxiliaryData.data.exists(d, d.name == 'RECIPIENT_MOBILENO') ? \n            [\n              {\n                'type': 'notification',\n                'trackedEventCode': 'NRBRS',\n                'originatingTrackedEventCode': 'EVGPD',\n                'notificationDestination': message.MPE.manualScan.auxiliaryData.data.filter(d, d.name == 'RECIPIENT_MOBILENO')[0].value,\n                'notificationDestinationType': 2,\n                'notificationRecipientType': 'R',\n                'eventTimestamp': message.MPE.manualScan.eventTimestamp,\n                'uniqueItemId': message.MPE.mailPiece.mailPieceBarcode.channelSegment.uniqueItemId,\n                'UPUTrackingNumber': message.MPE.mailPiece.mailPieceBarcode.channelSegment.UPUTrackingNumber\n              }\n            ] \n            : []\n          )\n        )\n      :\n      enrichment.productCategory.productCategory == 'Tracked48' ?\n        (\n          (message.MPE.manualScan.auxiliaryData.data.exists(d, d.name == 'RECIPIENT_EMAILID') ? \n            [\n              {\n                'type': 'notification',\n                'trackedEventCode': 'NRERS',\n                'originatingTrackedEventCode': 'EVGPD',\n                'notificationDestination': message.MPE.manualScan.auxiliaryData.data.filter(d, d.name == 'RECIPIENT_EMAILID')[0].value,\n                'notificationDestinationType': 1,\n                'notificationRecipientType': 'R',\n                'eventTimestamp': message.MPE.manualScan.eventTimestamp,\n                'uniqueItemId': message.MPE.mailPiece.mailPieceBarcode.channelSegment.uniqueItemId,\n                'UPUTrackingNumber': message.MPE.mailPiece.mailPieceBarcode.channelSegment.UPUTrackingNumber\n              }\n            ] \n            : []\n          ) +\n          (message.MPE.manualScan.auxiliaryData.data.exists(d, d.name == 'RECIPIENT_MOBILENO') ? \n            [\n              {\n                'type': 'notification',\n                'trackedEventCode': 'NRERS',\n                'originatingTrackedEventCode': 'EVGPD',\n                'notificationDestination': message.MPE.manualScan.auxiliaryData.data.filter(d, d.name == 'RECIPIENT_MOBILENO')[0].value,\n                'notificationDestinationType': 2,\n                'notificationRecipientType': 'R',\n                'eventTimestamp': message.MPE.manualScan.eventTimestamp,\n                'uniqueItemId': message.MPE.mailPiece.mailPieceBarcode.channelSegment.uniqueItemId,\n                'UPUTrackingNumber': message.MPE.mailPiece.mailPieceBarcode.channelSegment.UPUTrackingNumber\n              }\n            ] \n            : []\n          )\n        )\n      :\n      enrichment.productCategory.productCategory == 'SpecialDelivery09' ?\n        (\n          (message.MPE.manualScan.auxiliaryData.data.exists(d, d.name == 'RECIPIENT_EMAILID') ? \n            [\n              {\n                'type': 'notification',\n                'trackedEventCode': 'NRHRS',\n                'originatingTrackedEventCode': 'EVGPD',\n                'notificationDestination': message.MPE.manualScan.auxiliaryData.data.filter(d, d.name == 'RECIPIENT_EMAILID')[0].value,\n                'notificationDestinationType': 1,\n                'notificationRecipientType': 'R',\n                'eventTimestamp': message.MPE.manualScan.eventTimestamp,\n                'uniqueItemId': message.MPE.mailPiece.mailPieceBarcode.channelSegment.uniqueItemId,\n                'UPUTrackingNumber': message.MPE.mailPiece.mailPieceBarcode.channelSegment.UPUTrackingNumber\n              }\n            ] \n            : []\n          ) +\n          (message.MPE.manualScan.auxiliaryData.data.exists(d, d.name == 'RECIPIENT_MOBILENO') ? \n            [\n              {\n                'type': 'notification',\n                'trackedEventCode': 'NRHRS',\n                'originatingTrackedEventCode': 'EVGPD',\n                'notificationDestination': message.MPE.manualScan.auxiliaryData.data.filter(d, d.name == 'RECIPIENT_MOBILENO')[0].value,\n                'notificationDestinationType': 2,\n                'notificationRecipientType': 'R',\n                'eventTimestamp': message.MPE.manualScan.eventTimestamp,\n                'uniqueItemId': message.MPE.mailPiece.mailPieceBarcode.channelSegment.uniqueItemId,\n                'UPUTrackingNumber': message.MPE.mailPiece.mailPieceBarcode.channelSegment.UPUTrackingNumber\n              }\n            ] \n            : []\n          )\n        )\n      :\n      enrichment.productCategory.productCategory == 'SpecialDelivery13' ?\n        (\n          (message.MPE.manualScan.auxiliaryData.data.exists(d, d.name == 'RECIPIENT_EMAILID') ? \n            [\n              {\n                'type': 'notification',\n                'trackedEventCode': 'NRKRS',\n                'originatingTrackedEventCode': 'EVGPD',\n                'notificationDestination': message.MPE.manualScan.auxiliaryData.data.filter(d, d.name == 'RECIPIENT_EMAILID')[0].value,\n                'notificationDestinationType': 1,\n                'notificationRecipientType': 'R',\n                'eventTimestamp': message.MPE.manualScan.eventTimestamp,\n                'uniqueItemId': message.MPE.mailPiece.mailPieceBarcode.channelSegment.uniqueItemId,\n                'UPUTrackingNumber': message.MPE.mailPiece.mailPieceBarcode.channelSegment.UPUTrackingNumber\n              }\n            ] \n            : []\n          ) +\n          (message.MPE.manualScan.auxiliaryData.data.exists(d, d.name == 'RECIPIENT_MOBILENO') ? \n            [\n              {\n                'type': 'notification',\n                'trackedEventCode': 'NRKRS',\n                'originatingTrackedEventCode': 'EVGPD',\n                'notificationDestination': message.MPE.manualScan.auxiliaryData.data.filter(d, d.name == 'RECIPIENT_MOBILENO')[0].value,\n                'notificationDestinationType': 2,\n                'notificationRecipientType': 'R',\n                'eventTimestamp': message.MPE.manualScan.eventTimestamp,\n                'uniqueItemId': message.MPE.mailPiece.mailPieceBarcode.channelSegment.uniqueItemId,\n                'UPUTrackingNumber': message.MPE.mailPiece.mailPieceBarcode.channelSegment.UPUTrackingNumber\n              }\n            ] \n            : []\n          )\n        )\n      : []\n      )\n      : []\n    );\n    \n    let trackingOut = [\n      {\n        'type': 'tracking',\n        'eventCode': 'EVGPD',\n        'eventName': 'Out for Delivery',\n        'eventDateTime': message.MPE.manualScan.eventTimestamp,\n        'uniqueItemId': message.MPE.mailPiece.mailPieceBarcode.channelSegment.uniqueItemId,\n        'UPUTrackingNumber': message.MPE.mailPiece.mailPieceBarcode.channelSegment.UPUTrackingNumber,\n        'productId': message.MPE.mailPiece.mailPieceBarcode.channelSegment.productId,\n        'productName': enrichment.productCategory.productCategory,\n        'userId': has(message.MPE.manualScan.userId) ? message.MPE.manualScan.userId : '',\n        'deviceId': has(message.MPE.manualScan.deviceId) ? message.MPE.manualScan.deviceId : '',\n        'functionalLocationId': has(message.MPE.manualScan.RMGLocation.functionalLocationId) ? message.MPE.manualScan.RMGLocation.functionalLocationId : '',\n        'siteId': has(message.MPE.manualScan.RMGLocation.siteId) ? message.MPE.manualScan.RMGLocation.siteId : '',\n        'locationName': has(enrichment.deliveryOffice) ? enrichment.deliveryOffice : '',\n        'postcode': message.MPE.mailPiece.mailPieceBarcode.channelSegment.destinationPostcodeDPS.postcode,\n        'destinationCountry': message.MPE.mailPiece.mailPieceBarcode.channelSegment.destinationCountry,\n        'routeOrWalkNumber': has(message.MPE.manualScan.routeOrWalkNumber) ? message.MPE.manualScan.routeOrWalkNumber : '',\n        'longitude': has(message.MPE.manualScan.scanLocation.longitude) ? message.MPE.manualScan.scanLocation.longitude : 0.0,\n        'latitude': has(message.MPE.manualScan.scanLocation.latitude) ? message.MPE.manualScan.scanLocation.latitude : 0.0,\n        'altitude': has(message.MPE.manualScan.scanLocation.altitude) ? message.MPE.manualScan.scanLocation.altitude : 0.0\n      }\n    ];\n    \n    notificationOut + trackingOut\n  )\n}\n"
        }
      },
      "ENKDN": {
        "bizlogic": {
          "type": "cel",
          "cel": "{\n  'out': (\n    let notificationOut = (\n      has(enrichment.productCategory.productCategory) && \n      has(message.MPE.manualScan.auxiliaryData.data) ?\n      \n      (enrichment.productCategory.productCategory == 'Tracked24' ? \n        (message.MPE.manualScan.auxiliaryData.data.exists(d, d.name == 'RECIPIENT_EMAILID') ? \n          [\n            {\n              'type': 'notification',\n              'trackedEventCode': 'NRCRS',\n              'originatingTrackedEventCode': 'ENKDN',\n              'notificationDestination': message.MPE.manualScan.auxiliaryData.data.filter(d, d.name == 'RECIPIENT_EMAILID')[0].value,\n              'notificationDestinationType': 1,\n              'notificationRecipientType': 'R',\n              'eventTimestamp': message.MPE.manualScan.eventTimestamp,\n              'uniqueItemId': message.MPE.mailPiece.mailPieceBarcode.channelSegment.uniqueItemId,\n              'UPUTrackingNumber': message.MPE.mailPiece.mailPieceBarcode.channelSegment.UPUTrackingNumber\n            }\n          ] \n          : []\n        )\n      :\n      enrichment.productCategory.productCategory == 'Tracked48' ?\n        (message.MPE.manualScan.auxiliaryData.data.exists(d, d.name == 'RECIPIENT_MOBILENO') ? \n          [\n            {\n              'type': 'notification',\n              'trackedEventCode': 'NRFRS',\n              'originatingTrackedEventCode': 'ENKDN',\n              'notificationDestination': message.MPE.manualScan.auxiliaryData.data.filter(d, d.name == 'RECIPIENT_MOBILENO')[0].value,\n              'notificationDestinationType': 2,\n              'notificationRecipientType': 'R',\n              'eventTimestamp': message.MPE.manualScan.eventTimestamp,\n              'uniqueItemId': message.MPE.mailPiece.mailPieceBarcode.channelSegment.uniqueItemId,\n              'UPUTrackingNumber': message.MPE.mailPiece.mailPieceBarcode.channelSegment.UPUTrackingNumber\n            }\n          ] \n          : []\n        )\n      :\n      enrichment.productCategory.productCategory == 'SpecialDelivery09' ?\n        (message.MPE.manualScan.auxiliaryData.data.exists(d, d.name == 'RECIPIENT_MOBILENO') ? \n          [\n            {\n              'type': 'notification',\n              'trackedEventCode': 'NRIRS',\n              'originatingTrackedEventCode': 'ENKDN',\n              'notificationDestination': message.MPE.manualScan.auxiliaryData.data.filter(d, d.name == 'RECIPIENT_MOBILENO')[0].value,\n              'notificationDestinationType': 2,\n              'notificationRecipientType': 'R',\n              'eventTimestamp': message.MPE.manualScan.eventTimestamp,\n              'uniqueItemId': message.MPE.mailPiece.mailPieceBarcode.channelSegment.uniqueItemId,\n              'UPUTrackingNumber': message.MPE.mailPiece.mailPieceBarcode.channelSegment.UPUTrackingNumber\n            }\n          ] \n          : []\n        )\n      :\n      enrichment.productCategory.productCategory == 'SpecialDelivery13' ?\n        (\n          (message.MPE.manualScan.auxiliaryData.data.exists(d, d.name == 'RECIPIENT_EMAILID') ? \n            [\n              {\n                'type': 'notification',\n                'trackedEventCode': 'NRLRS',\n                'originatingTrackedEventCode': 'ENKDN',\n                'notificationDestination': message.MPE.manualScan.auxiliaryData.data.filter(d, d.name == 'RECIPIENT_EMAILID')[0].value,\n                'notificationDestinationType': 1,\n                'notificationRecipientType': 'R',\n                'eventTimestamp': message.MPE.manualScan.eventTimestamp,\n                'uniqueItemId': message.MPE.mailPiece.mailPieceBarcode.channelSegment.uniqueItemId,\n                'UPUTrackingNumber': message.MPE.mailPiece.mailPieceBarcode.channelSegment.UPUTrackingNumber\n              }\n            ] \n            : []\n          ) +\n          (message.MPE.manualScan.auxiliaryData.data.exists(d, d.name == 'RECIPIENT_MOBILENO') ? \n            [\n              {\n                'type': 'notification',\n                'trackedEventCode': 'NRLRS',\n                'originatingTrackedEventCode': 'ENKDN',\n                'notificationDestination': message.MPE.manualScan.auxiliaryData.data.filter(d, d.name == 'RECIPIENT_MOBILENO')[0].value,\n                'notificationDestinationType': 2,\n                'notificationRecipientType': 'R',\n                'eventTimestamp': message.MPE.manualScan.eventTimestamp,\n                'uniqueItemId': message.MPE.mailPiece.mailPieceBarcode.channelSegment.uniqueItemId,\n                'UPUTrackingNumber': message.MPE.mailPiece.mailPieceBarcode.channelSegment.UPUTrackingNumber\n              }\n            ] \n            : []\n          )\n        )\n      : []\n      )\n      : []\n    );\n    \n    let trackingOut = [\n      {\n        'type': 'tracking',\n        'eventCode': 'ENKDN',\n        'eventName': 'Delivered',\n        'eventDateTime': message.MPE.manualScan.eventTimestamp,\n        'uniqueItemId': message.MPE.mailPiece.mailPieceBarcode.channelSegment.uniqueItemId,\n        'UPUTrackingNumber': message.MPE.mailPiece.mailPieceBarcode.channelSegment.UPUTrackingNumber,\n        'productId': message.MPE.mailPiece.mailPieceBarcode.channelSegment.productId,\n        'productName': enrichment.productCategory.productCategory,\n        'userId': has(message.MPE.manualScan.userId) ? message.MPE.manualScan.userId : '',\n        'deviceId': has(message.MPE.manualScan.deviceId) ? message.MPE.manualScan.deviceId : '',\n        'functionalLocationId': has(message.MPE.manualScan.RMGLocation.functionalLocationId) ? message.MPE.manualScan.RMGLocation.functionalLocationId : '',\n        'siteId': has(message.MPE.manualScan.RMGLocation.siteId) ? message.MPE.manualScan.RMGLocation.siteId : '',\n        'locationName': has(enrichment.deliveryLocation) ? enrichment.deliveryLocation : '',\n        'postcode': message.MPE.mailPiece.mailPieceBarcode.channelSegment.destinationPostcodeDPS.postcode,\n        'destinationCountry': message.MPE.mailPiece.mailPieceBarcode.channelSegment.destinationCountry,\n        'routeOrWalkNumber': has(message.MPE.manualScan.routeOrWalkNumber) ? message.MPE.manualScan.routeOrWalkNumber : '',\n        'longitude': has(message.MPE.manualScan.scanLocation.longitude) ? message.MPE.manualScan.scanLocation.longitude : 0.0,\n        'latitude': has(message.MPE.manualScan.scanLocation.latitude) ? message.MPE.manualScan.scanLocation.latitude : 0.0,\n        'altitude': has(message.MPE.manualScan.scanLocation.altitude) ? message.MPE.manualScan.scanLocation.altitude : 0.0\n      }\n    ];\n    \n    notificationOut + trackingOut\n  )\n}\n"
        }
      }
    }
  }
}