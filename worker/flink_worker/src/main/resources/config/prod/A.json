{
  "events": {
    "EVDAV": {
      "bizlogic": {
        "all": {
          "type": "cel",
          "cel": "{'out': ((message.MPE.manualScan.auxiliaryData.data != null && message.MPE.manualScan.auxiliaryData.data.size() > 0 && message.MPE.manualScan.auxiliaryData.data[0].name == 'RECIPIENT_EMAILID' && message.MPE.mailPiece.mailPieceBarcode.channelSegment.productId == '100') ? [{'type': 'notification', 'trackedEventCode': 'NRARS', 'originatingTrackedEventCode': 'EVDAV', 'notificationDestination': string(message.MPE.manualScan.auxiliaryData.data[0].value), 'notificationDestinationType': '1', 'notificationRecipientType': 'R', 'eventTimestamp': string(message.MPE.manualScan.eventTimestamp), 'uniqueItemId': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.uniqueItemId), 'UPUTrackingNumber': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.UPUTrackingNumber)}] : (message.MPE.manualScan.auxiliaryData.data != null && message.MPE.manualScan.auxiliaryData.data.size() > 0 && message.MPE.manualScan.auxiliaryData.data[0].name == 'RECIPIENT_EMAILID' && message.MPE.mailPiece.mailPieceBarcode.channelSegment.productId == '101') ? [{'type': 'notification', 'trackedEventCode': 'NRERS', 'originatingTrackedEventCode': 'EVDAV', 'notificationDestination': string(message.MPE.manualScan.auxiliaryData.data[0].value), 'notificationDestinationType': '1', 'notificationRecipientType': 'R', 'eventTimestamp': string(message.MPE.manualScan.eventTimestamp), 'uniqueItemId': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.uniqueItemId), 'UPUTrackingNumber': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.UPUTrackingNumber)}] : (message.MPE.manualScan.auxiliaryData.data != null && message.MPE.manualScan.auxiliaryData.data.size() > 0 && message.MPE.manualScan.auxiliaryData.data[0].name == 'RECIPIENT_EMAILID' && message.MPE.mailPiece.mailPieceBarcode.channelSegment.productId == '109') ? [{'type': 'notification', 'trackedEventCode': 'NRGRS', 'originatingTrackedEventCode': 'EVDAV', 'notificationDestination': string(message.MPE.manualScan.auxiliaryData.data[0].value), 'notificationDestinationType': '1', 'notificationRecipientType': 'R', 'eventTimestamp': string(message.MPE.manualScan.eventTimestamp), 'uniqueItemId': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.uniqueItemId), 'UPUTrackingNumber': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.UPUTrackingNumber)}] : []) + ((message.MPE.manualScan.auxiliaryData.data != null && message.MPE.manualScan.auxiliaryData.data.size() > 1 && message.MPE.manualScan.auxiliaryData.data[1].name == 'RECIPIENT_MOBILENO' && message.MPE.mailPiece.mailPieceBarcode.channelSegment.productId == '109') ? [{'type': 'notification', 'trackedEventCode': 'NRGRS', 'originatingTrackedEventCode': 'EVDAV', 'notificationDestination': string(message.MPE.manualScan.auxiliaryData.data[1].value), 'notificationDestinationType': '2', 'notificationRecipientType': 'R', 'eventTimestamp': string(message.MPE.manualScan.eventTimestamp), 'uniqueItemId': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.uniqueItemId), 'UPUTrackingNumber': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.UPUTrackingNumber)}] : (message.MPE.manualScan.auxiliaryData.data != null && message.MPE.manualScan.auxiliaryData.data.size() > 1 && message.MPE.manualScan.auxiliaryData.data[1].name == 'RECIPIENT_MOBILENO' && message.MPE.mailPiece.mailPieceBarcode.channelSegment.productId == '113') ? [{'type': 'notification', 'trackedEventCode': 'NRJRS', 'originatingTrackedEventCode': 'EVDAV', 'notificationDestination': string(message.MPE.manualScan.auxiliaryData.data[1].value), 'notificationDestinationType': '2', 'notificationRecipientType': 'R', 'eventTimestamp': string(message.MPE.manualScan.eventTimestamp), 'uniqueItemId': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.uniqueItemId), 'UPUTrackingNumber': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.UPUTrackingNumber)}] : []) + [{'type': 'tracking', 'eventCode': 'EVDAV', 'eventName': 'Accepted at Depot', 'eventDateTime': string(message.MPE.manualScan.eventTimestamp), 'uniqueItemId': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.uniqueItemId), 'UPUTrackingNumber': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.UPUTrackingNumber), 'productId': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.productId), 'functionalLocationId': string(message.MPE.manualScan.RMGLocation.functionalLocationId), 'siteId': string(message.MPE.manualScan.RMGLocation.siteId), 'postcode': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.destinationPostcodeDPS.postcode), 'destinationCountry': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.destinationCountry)}]}"
        }
      },
      "enrichment": {
        "all": {
          "type": "composite",
          "enrichers": [
            {
              "type": "lookup",
              "inputs": [["message", "MPE", "mailPiece", "mailPieceBarcode", "channelSegment", "productId"]],
              "output": ["productCategory"],
              "lookup": {
                "100": {"productCategory": "Tracked24"},
                "101": {"productCategory": "Tracked48"},
                "109": {"productCategory": "SpecialDelivery09"},
                "113": {"productCategory": "SpecialDelivery13"}
              }
            }
          ]
        }
      }
    },
    "EVIMC": {
      "bizlogic": {
        "all": {
          "type": "cel",
          "cel": "{'out': [{'type': 'tracking', 'eventCode': 'EVIMC', 'eventName': 'Accepted at Mail Centre', 'eventDateTime': string(message.MPE.manualScan.eventTimestamp), 'uniqueItemId': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.uniqueItemId), 'UPUTrackingNumber': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.UPUTrackingNumber), 'productId': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.productId), 'functionalLocationId': string(message.MPE.manualScan.RMGLocation.functionalLocationId), 'siteId': string(message.MPE.manualScan.RMGLocation.siteId), 'postcode': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.destinationPostcodeDPS.postcode), 'destinationCountry': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.destinationCountry)}]}"
        }
      },
      "enrichment": {
        "all": {
          "type": "composite",
          "enrichers": [
            {
              "type": "lookup",
              "inputs": [["message", "MPE", "mailPiece", "mailPieceBarcode", "channelSegment", "productId"]],
              "output": ["productCategory"],
              "lookup": {
                "100": {"productCategory": "Tracked24"},
                "101": {"productCategory": "Tracked48"},
                "109": {"productCategory": "SpecialDelivery09"},
                "113": {"productCategory": "SpecialDelivery13"}
              }
            }
          ]
        }
      }
    },
    "EVGPD": {
      "bizlogic": {
        "all": {
          "type": "cel",
          "cel": "{'out': ((message.MPE.manualScan.auxiliaryData != null && message.MPE.manualScan.auxiliaryData.data != null && message.MPE.manualScan.auxiliaryData.data.size() > 0 && message.MPE.manualScan.auxiliaryData.data[0].name == 'RECIPIENT_EMAILID' && message.MPE.mailPiece.mailPieceBarcode.channelSegment.productId == '100') ? [{'type': 'notification', 'trackedEventCode': 'NRBRS', 'originatingTrackedEventCode': 'EVGPD', 'notificationDestination': string(message.MPE.manualScan.auxiliaryData.data[0].value), 'notificationDestinationType': '1', 'notificationRecipientType': 'R', 'eventTimestamp': string(message.MPE.manualScan.eventTimestamp), 'uniqueItemId': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.uniqueItemId), 'UPUTrackingNumber': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.UPUTrackingNumber)}] : (message.MPE.manualScan.auxiliaryData != null && message.MPE.manualScan.auxiliaryData.data != null && message.MPE.manualScan.auxiliaryData.data.size() > 0 && message.MPE.manualScan.auxiliaryData.data[0].name == 'RECIPIENT_EMAILID' && message.MPE.mailPiece.mailPieceBarcode.channelSegment.productId == '101') ? [{'type': 'notification', 'trackedEventCode': 'NRERS', 'originatingTrackedEventCode': 'EVGPD', 'notificationDestination': string(message.MPE.manualScan.auxiliaryData.data[0].value), 'notificationDestinationType': '1', 'notificationRecipientType': 'R', 'eventTimestamp': string(message.MPE.manualScan.eventTimestamp), 'uniqueItemId': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.uniqueItemId), 'UPUTrackingNumber': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.UPUTrackingNumber)}] : (message.MPE.manualScan.auxiliaryData != null && message.MPE.manualScan.auxiliaryData.data != null && message.MPE.manualScan.auxiliaryData.data.size() > 0 && message.MPE.manualScan.auxiliaryData.data[0].name == 'RECIPIENT_EMAILID' && message.MPE.mailPiece.mailPieceBarcode.channelSegment.productId == '109') ? [{'type': 'notification', 'trackedEventCode': 'NRHRS', 'originatingTrackedEventCode': 'EVGPD', 'notificationDestination': string(message.MPE.manualScan.auxiliaryData.data[0].value), 'notificationDestinationType': '1', 'notificationRecipientType': 'R', 'eventTimestamp': string(message.MPE.manualScan.eventTimestamp), 'uniqueItemId': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.uniqueItemId), 'UPUTrackingNumber': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.UPUTrackingNumber)}] : (message.MPE.manualScan.auxiliaryData != null && message.MPE.manualScan.auxiliaryData.data != null && message.MPE.manualScan.auxiliaryData.data.size() > 0 && message.MPE.manualScan.auxiliaryData.data[0].name == 'RECIPIENT_EMAILID' && message.MPE.mailPiece.mailPieceBarcode.channelSegment.productId == '113') ? [{'type': 'notification', 'trackedEventCode': 'NRKRS', 'originatingTrackedEventCode': 'EVGPD', 'notificationDestination': string(message.MPE.manualScan.auxiliaryData.data[0].value), 'notificationDestinationType': '1', 'notificationRecipientType': 'R', 'eventTimestamp': string(message.MPE.manualScan.eventTimestamp), 'uniqueItemId': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.uniqueItemId), 'UPUTrackingNumber': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.UPUTrackingNumber)}] : []) + ((message.MPE.manualScan.auxiliaryData != null && message.MPE.manualScan.auxiliaryData.data != null && message.MPE.manualScan.auxiliaryData.data.size() > 1 && message.MPE.manualScan.auxiliaryData.data[1].name == 'RECIPIENT_MOBILENO' && message.MPE.mailPiece.mailPieceBarcode.channelSegment.productId == '100') ? [{'type': 'notification', 'trackedEventCode': 'NRBRS', 'originatingTrackedEventCode': 'EVGPD', 'notificationDestination': string(message.MPE.manualScan.auxiliaryData.data[1].value), 'notificationDestinationType': '2', 'notificationRecipientType': 'R', 'eventTimestamp': string(message.MPE.manualScan.eventTimestamp), 'uniqueItemId': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.uniqueItemId), 'UPUTrackingNumber': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.UPUTrackingNumber)}] : (message.MPE.manualScan.auxiliaryData != null && message.MPE.manualScan.auxiliaryData.data != null && message.MPE.manualScan.auxiliaryData.data.size() > 1 && message.MPE.manualScan.auxiliaryData.data[1].name == 'RECIPIENT_MOBILENO' && message.MPE.mailPiece.mailPieceBarcode.channelSegment.productId == '101') ? [{'type': 'notification', 'trackedEventCode': 'NRERS', 'originatingTrackedEventCode': 'EVGPD', 'notificationDestination': string(message.MPE.manualScan.auxiliaryData.data[1].value), 'notificationDestinationType': '2', 'notificationRecipientType': 'R', 'eventTimestamp': string(message.MPE.manualScan.eventTimestamp), 'uniqueItemId': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.uniqueItemId), 'UPUTrackingNumber': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.UPUTrackingNumber)}] : (message.MPE.manualScan.auxiliaryData != null && message.MPE.manualScan.auxiliaryData.data != null && message.MPE.manualScan.auxiliaryData.data.size() > 1 && message.MPE.manualScan.auxiliaryData.data[1].name == 'RECIPIENT_MOBILENO' && message.MPE.mailPiece.mailPieceBarcode.channelSegment.productId == '109') ? [{'type': 'notification', 'trackedEventCode': 'NRHRS', 'originatingTrackedEventCode': 'EVGPD', 'notificationDestination': string(message.MPE.manualScan.auxiliaryData.data[1].value), 'notificationDestinationType': '2', 'notificationRecipientType': 'R', 'eventTimestamp': string(message.MPE.manualScan.eventTimestamp), 'uniqueItemId': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.uniqueItemId), 'UPUTrackingNumber': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.UPUTrackingNumber)}] : (message.MPE.manualScan.auxiliaryData != null && message.MPE.manualScan.auxiliaryData.data != null && message.MPE.manualScan.auxiliaryData.data.size() > 1 && message.MPE.manualScan.auxiliaryData.data[1].name == 'RECIPIENT_MOBILENO' && message.MPE.mailPiece.mailPieceBarcode.channelSegment.productId == '113') ? [{'type': 'notification', 'trackedEventCode': 'NRKRS', 'originatingTrackedEventCode': 'EVGPD', 'notificationDestination': string(message.MPE.manualScan.auxiliaryData.data[1].value), 'notificationDestinationType': '2', 'notificationRecipientType': 'R', 'eventTimestamp': string(message.MPE.manualScan.eventTimestamp), 'uniqueItemId': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.uniqueItemId), 'UPUTrackingNumber': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.UPUTrackingNumber)}] : []) + [{'type': 'tracking', 'eventCode': 'EVGPD', 'eventName': 'Out for Delivery', 'eventDateTime': string(message.MPE.manualScan.eventTimestamp), 'uniqueItemId': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.uniqueItemId), 'UPUTrackingNumber': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.UPUTrackingNumber), 'productId': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.productId), 'userId': string(message.MPE.manualScan.userId), 'deviceId': string(message.MPE.manualScan.deviceId), 'functionalLocationId': string(message.MPE.manualScan.RMGLocation.functionalLocationId), 'siteId': string(message.MPE.manualScan.RMGLocation.siteId), 'postcode': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.destinationPostcodeDPS.postcode), 'destinationCountry': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.destinationCountry), 'longitude': string(message.MPE.manualScan.scanLocation.longitude), 'latitude': string(message.MPE.manualScan.scanLocation.latitude), 'altitude': string(message.MPE.manualScan.scanLocation.altitude)}]}"
        }
      },
      "enrichment": {
        "all": {
          "type": "composite",
          "enrichers": [
            {
              "type": "lookup",
              "inputs": [["message", "MPE", "mailPiece", "mailPieceBarcode", "channelSegment", "productId"]],
              "output": ["productCategory"],
              "lookup": {
                "100": {"productCategory": "Tracked24"},
                "101": {"productCategory": "Tracked48"},
                "109": {"productCategory": "SpecialDelivery09"},
                "113": {"productCategory": "SpecialDelivery13"}
              }
            }
          ]
        }
      }
    },
    "ENKDN": {
      "bizlogic": {
        "all": {
          "type": "cel",
          "cel": "{'out': ((message.MPE.manualScan.auxiliaryData != null && message.MPE.manualScan.auxiliaryData.data != null && message.MPE.manualScan.auxiliaryData.data.size() > 0 && message.MPE.manualScan.auxiliaryData.data[0].name == 'RECIPIENT_EMAILID' && message.MPE.mailPiece.mailPieceBarcode.channelSegment.productId == '100') ? [{'type': 'notification', 'trackedEventCode': 'NRCRS', 'originatingTrackedEventCode': 'ENKDN', 'notificationDestination': string(message.MPE.manualScan.auxiliaryData.data[0].value), 'notificationDestinationType': '1', 'notificationRecipientType': 'R', 'eventTimestamp': string(message.MPE.manualScan.eventTimestamp), 'uniqueItemId': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.uniqueItemId), 'UPUTrackingNumber': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.UPUTrackingNumber)}] : (message.MPE.manualScan.auxiliaryData != null && message.MPE.manualScan.auxiliaryData.data != null && message.MPE.manualScan.auxiliaryData.data.size() > 0 && message.MPE.manualScan.auxiliaryData.data[0].name == 'RECIPIENT_EMAILID' && message.MPE.mailPiece.mailPieceBarcode.channelSegment.productId == '113') ? [{'type': 'notification', 'trackedEventCode': 'NRLRS', 'originatingTrackedEventCode': 'ENKDN', 'notificationDestination': string(message.MPE.manualScan.auxiliaryData.data[0].value), 'notificationDestinationType': '1', 'notificationRecipientType': 'R', 'eventTimestamp': string(message.MPE.manualScan.eventTimestamp), 'uniqueItemId': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.uniqueItemId), 'UPUTrackingNumber': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.UPUTrackingNumber)}] : []) + ((message.MPE.manualScan.auxiliaryData != null && message.MPE.manualScan.auxiliaryData.data != null && message.MPE.manualScan.auxiliaryData.data.size() > 1 && message.MPE.manualScan.auxiliaryData.data[1].name == 'RECIPIENT_MOBILENO' && message.MPE.mailPiece.mailPieceBarcode.channelSegment.productId == '101') ? [{'type': 'notification', 'trackedEventCode': 'NRFRS', 'originatingTrackedEventCode': 'ENKDN', 'notificationDestination': string(message.MPE.manualScan.auxiliaryData.data[1].value), 'notificationDestinationType': '2', 'notificationRecipientType': 'R', 'eventTimestamp': string(message.MPE.manualScan.eventTimestamp), 'uniqueItemId': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.uniqueItemId), 'UPUTrackingNumber': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.UPUTrackingNumber)}] : (message.MPE.manualScan.auxiliaryData != null && message.MPE.manualScan.auxiliaryData.data != null && message.MPE.manualScan.auxiliaryData.data.size() > 1 && message.MPE.manualScan.auxiliaryData.data[1].name == 'RECIPIENT_MOBILENO' && message.MPE.mailPiece.mailPieceBarcode.channelSegment.productId == '109') ? [{'type': 'notification', 'trackedEventCode': 'NRIRS', 'originatingTrackedEventCode': 'ENKDN', 'notificationDestination': string(message.MPE.manualScan.auxiliaryData.data[1].value), 'notificationDestinationType': '2', 'notificationRecipientType': 'R', 'eventTimestamp': string(message.MPE.manualScan.eventTimestamp), 'uniqueItemId': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.uniqueItemId), 'UPUTrackingNumber': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.UPUTrackingNumber)}] : (message.MPE.manualScan.auxiliaryData != null && message.MPE.manualScan.auxiliaryData.data != null && message.MPE.manualScan.auxiliaryData.data.size() > 1 && message.MPE.manualScan.auxiliaryData.data[1].name == 'RECIPIENT_MOBILENO' && message.MPE.mailPiece.mailPieceBarcode.channelSegment.productId == '113') ? [{'type': 'notification', 'trackedEventCode': 'NRLRS', 'originatingTrackedEventCode': 'ENKDN', 'notificationDestination': string(message.MPE.manualScan.auxiliaryData.data[1].value), 'notificationDestinationType': '2', 'notificationRecipientType': 'R', 'eventTimestamp': string(message.MPE.manualScan.eventTimestamp), 'uniqueItemId': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.uniqueItemId), 'UPUTrackingNumber': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.UPUTrackingNumber)}] : []) + [{'type': 'tracking', 'eventCode': 'ENKDN', 'eventName': 'Delivered', 'eventDateTime': string(message.MPE.manualScan.eventTimestamp), 'uniqueItemId': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.uniqueItemId), 'UPUTrackingNumber': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.UPUTrackingNumber), 'productId': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.productId), 'userId': string(message.MPE.manualScan.userId), 'deviceId': string(message.MPE.manualScan.deviceId), 'functionalLocationId': string(message.MPE.manualScan.RMGLocation.functionalLocationId), 'siteId': string(message.MPE.manualScan.RMGLocation.siteId), 'postcode': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.destinationPostcodeDPS.postcode), 'destinationCountry': string(message.MPE.mailPiece.mailPieceBarcode.channelSegment.destinationCountry), 'longitude': string(message.MPE.manualScan.scanLocation.longitude), 'latitude': string(message.MPE.manualScan.scanLocation.latitude), 'altitude': string(message.MPE.manualScan.scanLocation.altitude)}]}"
        }
      },
      "enrichment": {
        "all": {
          "type": "composite",
          "enrichers": [
            {
              "type": "lookup",
              "inputs": [["message", "MPE", "mailPiece", "mailPieceBarcode", "channelSegment", "productId"]],
              "output": ["productCategory"],
              "lookup": {
                "100": {"productCategory": "Tracked24"},
                "101": {"productCategory": "Tracked48"},
                "109": {"productCategory": "SpecialDelivery09"},
                "113": {"productCategory": "SpecialDelivery13"}
              }
            }
          ]
        }
      }
    }
  }
}